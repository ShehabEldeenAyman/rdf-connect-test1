export async function timeout(ms, promise) {
    if (ms === null) {
        return promise;
    }
    let timeoutHandle;
    const timeoutPromise = new Promise((_, reject) => {
        timeoutHandle = setTimeout(() => reject(), ms);
    }).catch(() => {
        throw "timeout";
    });
    return Promise.race([promise, timeoutPromise]).finally(() => {
        clearTimeout(timeoutHandle);
    });
}
